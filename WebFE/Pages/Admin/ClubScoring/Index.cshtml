@page
@model WebFE.Pages.Admin.ClubScoring.IndexModel
@{
    ViewData["Title"] = "Club Scoring";
    Layout = "~/Pages/Shared/_AdminLayout.cshtml";
}

<!-- Breadcrumb -->
<nav aria-label="breadcrumb" class="mb-3">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/Admin">Admin</a></li>
        <li class="breadcrumb-item active">Club Scoring</li>
    </ol>
</nav>

<!-- Page Header -->
<div class="page-header mb-3">
    <div class="d-flex align-items-center justify-content-between flex-wrap gap-3">
        <div>
            <h1 class="page-title">
                <i data-lucide="trophy" style="width: 28px; height: 28px; display: inline-block; vertical-align: middle; margin-right: 0.5rem;"></i>
                Club Scoring
            </h1>
            <p class="page-description">List of club scores by month</p>
        </div>
        <div class="d-flex gap-2">
            <button type="button" class="btn btn-success" onclick="window.open('@Model.ExportUrl', '_blank')">
                <i data-lucide="download" style="width: 16px; height: 16px;"></i>
                Export Excel
            </button>
            <a class="btn btn-primary" href="#" onclick="window.print(); return false;">
                <i data-lucide="printer" style="width: 16px; height: 16px;"></i>
                Print Report
            </a>
        </div>
    </div>
</div>

<!-- Filter Card -->
<div class="card border-0 shadow-sm">
    <div class="card-header bg-light d-flex align-items-center justify-content-center py-3">
        <i data-lucide="filter" style="width: 20px; height: 20px; margin-right: 0.5rem;"></i>
        <strong>Filter</strong>
    </div>
    <div class="card-body">
        <form method="get" class="row g-3 align-items-end">
            <div class="col-md-4">
                <label class="form-label">
                    <i data-lucide="calendar" style="width: 16px; height: 16px; margin-right: 0.5rem;"></i>
                    <strong>Semester</strong>
                </label>
                <select class="form-select" name="semesterId" asp-for="SelectedSemesterId">
                    @foreach (var s in Model.Semesters)
                    {
                        <option value="@s.Id" selected="@(Model.SelectedSemesterId == s.Id)">@s.Name</option>
                    }
                </select>
            </div>
            <div class="col-md-3">
                <label class="form-label">
                    <i data-lucide="calendar-days" style="width: 16px; height: 16px; margin-right: 0.5rem;"></i>
                    <strong>Month</strong>
                </label>
                <select class="form-select" name="month" asp-for="SelectedMonth">
                    @foreach (var mo in Model.MonthOptions)
                    {
                        <option value="@mo.Month" selected="@(Model.SelectedMonth == mo.Month)">@mo.Display</option>
                    }
                </select>
            </div>
            <div class="col-md-3">
                <button type="submit" class="btn btn-primary">
                    <i data-lucide="search"></i> Filter
                </button>
            </div>
        </form>
    </div>
</div>

<!-- KPIs -->
<div class="row g-3 mt-3">
    <div class="col-md-4">
        <div class="card border-0 shadow-sm">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <div class="text-muted">
                            <i data-lucide="users" style="width: 16px; height: 16px; margin-right: 0.25rem;"></i>
                            Total Clubs
                        </div>
                        <div class="fs-3 fw-bold text-primary">@Model.TotalClubs</div>
                    </div>
                    <i data-lucide="users" style="width: 32px; height: 32px; color: #0d6efd;"></i>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card border-0 shadow-sm">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <div class="text-muted">
                            <i data-lucide="check-circle" style="width: 16px; height: 16px; margin-right: 0.25rem;"></i>
                            Scored
                        </div>
                        <div class="fs-3 fw-bold text-success">@Model.ScoredClubs</div>
                    </div>
                    <i data-lucide="check-circle" style="width: 32px; height: 32px; color: #198754;"></i>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card border-0 shadow-sm">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <div class="text-muted">
                            <i data-lucide="clock" style="width: 16px; height: 16px; margin-right: 0.25rem;"></i>
                            Not Scored
                        </div>
                        <div class="fs-3 fw-bold text-warning">@Model.UnscoredClubs</div>
                    </div>
                    <i data-lucide="clock" style="width: 32px; height: 32px; color: #ffc107;"></i>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Clubs Table -->
<div class="card border-0 shadow-sm mt-3">
    <div class="card-header bg-warning text-dark d-flex align-items-center justify-content-center py-3">
        <i data-lucide="table" style="width: 20px; height: 20px; margin-right: 0.5rem;"></i>
        <strong>Club List</strong>
    </div>
    <div class="card-body">
        @if (Model.ClubScores?.Any() == true)
        {
            <div class="table-responsive">
                <table class="table table-hover align-middle">
                    <thead>
                        <tr>
                            <th><i data-lucide="hash" style="width: 16px; height: 16px; margin-right: 0.25rem;"></i>#</th>
                            <th><i data-lucide="users" style="width: 16px; height: 16px; margin-right: 0.25rem;"></i>Club</th>
                            <th><i data-lucide="calendar" style="width: 16px; height: 16px; margin-right: 0.25rem;"></i>Meetings</th>
                            <th><i data-lucide="calendar-days" style="width: 16px; height: 16px; margin-right: 0.25rem;"></i>Events</th>
                            <th><i data-lucide="handshake" style="width: 16px; height: 16px; margin-right: 0.25rem;"></i>Collaborations</th>
                            <th><i data-lucide="trophy" style="width: 16px; height: 16px; margin-right: 0.25rem;"></i>Competitions</th>
                            <th><i data-lucide="clipboard" style="width: 16px; height: 16px; margin-right: 0.25rem;"></i>Plans</th>
                            <th><i data-lucide="star" style="width: 16px; height: 16px; margin-right: 0.25rem;"></i>Total</th>
                            <th><i data-lucide="eye" style="width: 16px; height: 16px; margin-right: 0.25rem;"></i>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        @for (int i = 0; i < Model.ClubScores.Count; i++)
                        {
                            var r = Model.ClubScores[i];
                            <tr>
                                <td><span class="badge bg-secondary">@(i + 1)</span></td>
                                <td><strong>@r.ClubName</strong></td>
                                <td><span class="badge bg-info">@r.ClubMeetingScore</span></td>
                                <td><span class="badge bg-info">@r.EventScore</span></td>
                                <td><span class="badge bg-info">@r.CollaborationScore</span></td>
                                <td><span class="badge bg-info">@r.CompetitionScore</span></td>
                                <td><span class="badge bg-info">@r.PlanScore</span></td>
                                <td><strong class="text-primary fs-5">@r.TotalScore</strong></td>
                                <td>
                                    <a class="btn btn-sm btn-outline-primary"
                                       asp-page="Detail"
                                       asp-route-clubId="@r.ClubId"
                                       asp-route-semesterId="@Model.SelectedSemesterId"
                                       asp-route-month="@Model.SelectedMonth">
                                        <i data-lucide="external-link"></i> Details
                                    </a>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        }
        else
        {
            <div class="text-center text-muted py-5">
                <i data-lucide="inbox" style="width: 48px; height: 48px; margin-bottom: 1rem;"></i>
                <div>No data available</div>
            </div>
        }
    </div>
</div>

@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function(){ if (typeof lucide !== 'undefined') lucide.createIcons(); });
    </script>
}
