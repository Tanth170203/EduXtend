@page "{id:int}"
@model WebFE.Pages.Admin.Activities.DetailsModel
@{
    ViewData["Title"] = "Activity Details";
    Layout = "~/Pages/Shared/_AdminLayout.cshtml";
    var activity = Model.Activity!;
    
    // Check if activity has started or is completed
    var now = DateTime.Now;
    var hasStarted = activity.StartTime <= now;
    var isCompleted = activity.Status == "Completed";
    var canEdit = !hasStarted && !isCompleted;
}

<div class="container-fluid px-4 py-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2 class="mb-1 fw-bold">Activity Details</h2>
            <p class="text-muted mb-0">Detailed information about this activity</p>
        </div>
        <div>
            <a class="btn btn-outline-secondary me-2" href="/Admin/Activities">
                <i class="bi bi-arrow-left me-2"></i>Back to List
            </a>
            @if (canEdit)
            {
                <a class="btn btn-primary" href="/Admin/Activities/Edit/@activity.Id">
                    <i class="bi bi-pencil-square me-2"></i>Edit
                </a>
            }
            else
            {
                <button class="btn btn-secondary" disabled title="@(hasStarted ? "Cannot edit activity that has already started" : "Cannot edit completed activity")">
                    <i class="bi bi-pencil-square me-2"></i>Edit @(hasStarted ? "(Started)" : "(Completed)")
                </button>
            }
        </div>
    </div>

    <div class="row g-4">
        <!-- Main Information Card -->
        <div class="col-lg-8">
            <div class="card shadow-sm border-0 mb-4">
                <div class="card-body p-4">
                    <h3 class="fw-bold mb-3">@activity.Title</h3>
                    
                    @if (!string.IsNullOrWhiteSpace(activity.ImageUrl))
                    {
                        <img src="@activity.ImageUrl" class="img-fluid rounded mb-4" style="max-height: 300px; width: 100%; object-fit: cover;" alt="@activity.Title" />
                    }
                    
                    <div class="mb-4">
                        <h5 class="fw-semibold mb-3">Description</h5>
                        <p class="text-muted" style="white-space: pre-wrap;">@(activity.Description ?? "No description provided")</p>
                    </div>

                    <div class="row g-3">
                        <div class="col-md-6">
                            <div class="p-3 bg-light rounded">
                                <small class="text-muted d-block mb-1">Type</small>
                                <span class="badge bg-info">@activity.Type</span>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="p-3 bg-light rounded">
                                <small class="text-muted d-block mb-1">Status</small>
                                @{
                                    var statusClass = activity.Status switch
                                    {
                                        "Approved" => "success",
                                        "PendingApproval" => "warning",
                                        "Rejected" => "danger",
                                        "Completed" => "secondary",
                                        _ => "secondary"
                                    };
                                }
                                <span class="badge bg-@statusClass">@activity.Status</span>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="p-3 bg-light rounded">
                                <small class="text-muted d-block mb-1">Visibility</small>
                                @if (activity.IsPublic)
                                {
                                    <span class="badge bg-success">Public</span>
                                }
                                else
                                {
                                    <span class="badge bg-secondary">Private</span>
                                }
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="p-3 bg-light rounded">
                                <small class="text-muted d-block mb-1">Movement Points</small>
                                <strong class="text-success">+@activity.MovementPoint points</strong>
                            </div>
                        </div>
                    </div>

                    @* Display rejection reason if activity is rejected *@
                    @if (activity.Status == "Rejected" && !string.IsNullOrWhiteSpace(activity.RejectionReason))
                    {
                        <div class="alert alert-danger mt-4 mb-0" role="alert">
                            <div class="d-flex">
                                <i class="bi bi-exclamation-circle-fill me-3 fs-5" style="flex-shrink: 0;"></i>
                                <div>
                                    <h6 class="alert-heading mb-2 fw-bold">Rejection Reason</h6>
                                    <p class="mb-0" style="white-space: pre-wrap;">@activity.RejectionReason</p>
                                </div>
                            </div>
                        </div>
                    }
                </div>
            </div>

            <!-- Location & Schedule Card -->
            <div class="card shadow-sm border-0 mb-4">
                <div class="card-body p-4">
                    <h5 class="fw-semibold mb-3">Schedule & Location</h5>
                    <div class="row g-3">
                        <div class="col-md-6">
                            <div class="d-flex align-items-start">
                                <i class="bi bi-calendar-event text-primary me-3 fs-5"></i>
                                <div>
                                    <small class="text-muted d-block">Start Time</small>
                                    <strong>@activity.StartTime.ToString("dddd, dd MMMM yyyy")</strong>
                                    <div class="text-muted">@activity.StartTime.ToString("HH:mm")</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="d-flex align-items-start">
                                <i class="bi bi-calendar-check text-success me-3 fs-5"></i>
                                <div>
                                    <small class="text-muted d-block">End Time</small>
                                    <strong>@activity.EndTime.ToString("dddd, dd MMMM yyyy")</strong>
                                    <div class="text-muted">@activity.EndTime.ToString("HH:mm")</div>
                                </div>
                            </div>
                        </div>
                        @if (!string.IsNullOrWhiteSpace(activity.Location))
                        {
                            <div class="col-12">
                                <div class="d-flex align-items-start">
                                    <i class="bi bi-geo-alt text-danger me-3 fs-5"></i>
                                    <div>
                                        <small class="text-muted d-block">Location</small>
                                        <strong>@activity.Location</strong>
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>

            <!-- Activity Timeline -->
            <div id="scheduleDisplaySection" class="card shadow-sm border-0 mb-4" style="display: none;">
                <div class="card-body p-4">
                    <h5 class="fw-semibold mb-3">
                        <i class="bi bi-clock-history me-2"></i>
                        Activity Timeline
                    </h5>
                    <div id="timelineContainer" class="timeline">
                        <!-- Timeline items will be rendered here by JavaScript -->
                    </div>
                </div>
            </div>

            <!-- Creator & Approval Information -->
            <div class="card shadow-sm border-0">
                <div class="card-body p-4">
                    <h5 class="fw-semibold mb-3">System Information</h5>
                    <div class="row g-3">
                        <div class="col-md-6">
                            <small class="text-muted d-block mb-1">Created By</small>
                            <strong>@activity.CreatedByName</strong>
                        </div>
                        <div class="col-md-6">
                            <small class="text-muted d-block mb-1">Created At</small>
                            <strong>@activity.CreatedAt.ToString("dd/MM/yyyy HH:mm")</strong>
                        </div>
                        @if (activity.ApprovedById.HasValue)
                        {
                            <div class="col-md-6">
                                <small class="text-muted d-block mb-1">Approved By</small>
                                <strong>@activity.ApprovedByName</strong>
                            </div>
                            <div class="col-md-6">
                                <small class="text-muted d-block mb-1">Approved At</small>
                                <strong>@activity.ApprovedAt?.ToString("dd/MM/yyyy HH:mm")</strong>
                            </div>
                        }
                        <div class="col-md-6">
                            <small class="text-muted d-block mb-1">Requires Approval</small>
                            <strong>@(activity.RequiresApproval ? "Yes" : "No")</strong>
                        </div>
                        @if (activity.ClubId.HasValue)
                        {
                            <div class="col-md-6">
                                <small class="text-muted d-block mb-1">Club</small>
                                <strong>@activity.ClubName</strong>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>

        <!-- Sidebar Statistics -->
        <div class="col-lg-4">
            @* ============================================================
               ATTENDANCE CODE CARD - TEMPORARILY HIDDEN (not deleted)
               Code-based attendance is disabled, only GPS is supported
               Uncomment this section to re-enable code-based attendance
               ============================================================ *@
            @* 
            <!-- Attendance Code Card -->
            @if (!string.IsNullOrWhiteSpace(activity.AttendanceCode))
            {
                <div class="card shadow-sm border-0 mb-4 bg-warning bg-opacity-10">
                    <div class="card-body p-4">
                        <h5 class="fw-semibold mb-3">
                            <i class="bi bi-qr-code-scan me-2"></i>Attendance Code
                        </h5>
                        <div class="text-center">
                            <div class="bg-white rounded p-3 mb-3">
                                <code class="fs-3 fw-bold" style="letter-spacing: 0.3em; color: #333;">@activity.AttendanceCode</code>
                            </div>
                            <button class="btn btn-warning w-100" onclick="copyAttendanceCode(event, '@Html.Raw(activity.AttendanceCode)')">
                                <i class="bi bi-clipboard me-2"></i>Copy Code
                            </button>
                            <small class="text-muted d-block mt-2">Share this code with students for self check-in</small>
                        </div>
                    </div>
                </div>
            }
            *@
            
            <!-- Participation Stats -->
            <div class="card shadow-sm border-0 mb-4">
                <div class="card-body p-4">
                    <h5 class="fw-semibold mb-3">Participation Statistics</h5>
                    
                    <div class="mb-3">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="text-muted">Capacity</span>
                            <strong>@activity.CurrentParticipants @(activity.MaxParticipants.HasValue ? $"/ {activity.MaxParticipants}" : "")</strong>
                        </div>
                        @if (activity.MaxParticipants.HasValue)
                        {
                            var percentage = (activity.CurrentParticipants * 100.0 / activity.MaxParticipants.Value);
                            var progressClass = percentage >= 90 ? "bg-danger" : percentage >= 70 ? "bg-warning" : "bg-success";
                            <div class="progress" style="height: 8px;">
                                <div class="progress-bar @progressClass" role="progressbar" style="width: @percentage%"></div>
                            </div>
                        }
                    </div>

                    <div class="row g-3 text-center">
                        <div class="col-4">
                            <div class="p-3 bg-light rounded">
                                <h4 class="mb-1 text-primary">@activity.RegisteredCount</h4>
                                <small class="text-muted">Registered</small>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="p-3 bg-light rounded">
                                <h4 class="mb-1 text-success">@activity.AttendedCount</h4>
                                <small class="text-muted">Attended</small>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="p-3 bg-light rounded">
                                <h4 class="mb-1 text-info">@activity.FeedbackCount</h4>
                                <small class="text-muted">Feedback</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            @if (activity.Status == "Approved" || activity.Status == "Completed")
            {
                <div class="card shadow-sm border-0">
                    <div class="card-body p-4">
                        <h5 class="fw-semibold mb-3">Quick Actions</h5>
                        <div class="d-grid gap-2">
                            @if (activity.Status == "Approved")
                            {
                                @if (canEdit)
                                {
                                    <a href="/Admin/Activities/Edit/@activity.Id" class="btn btn-outline-primary">
                                        <i class="bi bi-pencil-square me-2"></i>Edit Activity
                                    </a>
                                }
                                else
                                {
                                    <button class="btn btn-outline-secondary" disabled title="@(hasStarted ? "Cannot edit activity that has already started" : "Cannot edit completed activity")">
                                        <i class="bi bi-pencil-square me-2"></i>Edit Activity @(hasStarted ? "(Started)" : "(Completed)")
                                    </button>
                                }
                                @if (!activity.ClubId.HasValue)
                                {
                                    <a href="/Admin/Activities/Attendances/@activity.Id" class="btn btn-outline-success">
                                        <i class="bi bi-clipboard-check me-2"></i>Manage Attendance
                                    </a>
                                }
                            }
                            @if (activity.Status == "Completed")
                            {
                                @if (!activity.ClubId.HasValue)
                                {
                                    <a href="/Admin/Activities/Attendances/@activity.Id" class="btn btn-outline-secondary">
                                        <i class="bi bi-clipboard-check me-2"></i>View Attendance
                                    </a>
                                }
                            }
                            <a href="/Admin/Activities/Feedbacks/@activity.Id" class="btn btn-outline-info">
                                <i class="bi bi-chat-dots me-2"></i>View Feedback
                            </a>
                            @if (activity.Status == "Approved")
                            {
                                @if (canEdit)
                                {
                                    <button class="btn btn-outline-danger" onclick="confirmDelete(@activity.Id, '@activity.Title')">
                                        <i class="bi bi-trash3 me-2"></i>Delete Activity
                                    </button>
                                }
                                else
                                {
                                    <button class="btn btn-outline-secondary" disabled title="@(hasStarted ? "Cannot delete activity that has already started" : "Cannot delete completed activity")">
                                        <i class="bi bi-trash3 me-2"></i>Delete Activity @(hasStarted ? "(Started)" : "(Completed)")
                                    </button>
                                }
                            }
                            <a href="/Admin/Activities" class="btn btn-outline-secondary">
                                <i class="bi bi-list me-2"></i>Back to List
                            </a>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header border-0">
                <h5 class="modal-title fw-bold" id="deleteModalLabel">
                    <i class="bi bi-exclamation-triangle text-warning me-2"></i>Confirm Delete
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p class="mb-2">Are you sure you want to delete this activity?</p>
                <p class="fw-semibold text-primary mb-0" id="activityTitle"></p>
                <p class="text-muted small mt-2">This action cannot be undone.</p>
            </div>
            <div class="modal-footer border-0">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-danger" id="confirmDeleteBtn">
                    <i class="bi bi-trash me-2"></i>Delete
                </button>
            </div>
        </div>
    </div>
</div>

<script>
    let deleteId = null;
    
    function confirmDelete(id, title) {
        deleteId = id;
        document.getElementById('activityTitle').textContent = title;
        const modal = new bootstrap.Modal(document.getElementById('deleteModal'));
        modal.show();
    }
    
    document.getElementById('confirmDeleteBtn').addEventListener('click', function() {
        if (deleteId) {
            window.location.href = '/Admin/Activities/Delete/' + deleteId;
        }
    });
    
    function copyAttendanceCode(evt, code) {
        navigator.clipboard.writeText(code).then(function() {
            // Show success feedback
            const btn = evt.target.closest('button');
            const originalHtml = btn.innerHTML;
            btn.innerHTML = '<i class="bi bi-check2 me-2"></i>Copied!';
            btn.classList.remove('btn-warning');
            btn.classList.add('btn-success');
            
            // Show success message
            showToast('Success', 'success');
            
            setTimeout(function() {
                btn.innerHTML = originalHtml;
                btn.classList.remove('btn-success');
                btn.classList.add('btn-warning');
            }, 2000);
        }).catch(function(err) {
            showToast('Không thể copy mã', 'danger');
        });
    }
    
    function showToast(message, type) {
        // Validate parameters
        if (!message) message = 'Thao tác thành công';
        if (!type) type = 'success';
        
        // Create toast container if not exists
        let toastContainer = document.getElementById('toastContainer');
        if (!toastContainer) {
            toastContainer = document.createElement('div');
            toastContainer.id = 'toastContainer';
            toastContainer.className = 'toast-container position-fixed top-0 end-0 p-3';
            toastContainer.style.zIndex = '9999';
            document.body.appendChild(toastContainer);
        }
        
        // Choose icon based on type
        const icon = type === 'success' ? 'bi-check-circle-fill' : 'bi-exclamation-circle-fill';
        
        // Create toast element
        const toastId = 'toast-' + Date.now();
        const toastDiv = document.createElement('div');
        toastDiv.id = toastId;
        toastDiv.className = `toast align-items-center text-white bg-${type} border-0`;
        toastDiv.setAttribute('role', 'alert');
        toastDiv.setAttribute('aria-live', 'assertive');
        toastDiv.setAttribute('aria-atomic', 'true');
        
        toastDiv.innerHTML = `
            <div class="d-flex">
                <div class="toast-body">
                    <i class="bi ${icon} me-2"></i>${message}
                </div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
        `;
        
        toastContainer.appendChild(toastDiv);
        const toast = new bootstrap.Toast(toastDiv, { delay: 3000 });
        toast.show();
        
        // Remove toast element after it's hidden
        toastDiv.addEventListener('hidden.bs.toast', function() {
            toastDiv.remove();
        });
    }
    
    // ===== Timeline Helper Functions =====
    
    // Activity type classification
    const COMPLEX_ACTIVITY_TYPES = [
        'LargeEvent', 'MediumEvent', 'SmallEvent',
        'SchoolCompetition', 'ProvincialCompetition', 'NationalCompetition',
        'ClubCollaboration', 'SchoolCollaboration'
    ];
    
    // Check if activity type is complex (requires schedules)
    function isComplexActivity(activityType) {
        return COMPLEX_ACTIVITY_TYPES.includes(activityType);
    }
    
    // Format time from TimeSpan (HH:mm:ss format) to readable format
    function formatTime(timeSpan) {
        if (!timeSpan) return '';
        
        // TimeSpan comes as "HH:mm:ss" string from API
        const parts = timeSpan.split(':');
        if (parts.length >= 2) {
            return `${parts[0]}:${parts[1]}`;
        }
        return timeSpan;
    }
    
    // Escape HTML to prevent XSS
    function escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }
    
    // Render timeline items
    function renderTimeline(schedules) {
        const container = document.getElementById('timelineContainer');
        
        if (!schedules || schedules.length === 0) {
            container.innerHTML = `
                <div class="text-center text-muted py-4">
                    <i class="bi bi-calendar-x fs-1 mb-3 d-block"></i>
                    <p class="mb-0">No schedule items available for this activity.</p>
                </div>
            `;
            return;
        }
        
        // Sort schedules by start time (handle both camelCase and PascalCase)
        const sortedSchedules = [...schedules].sort((a, b) => {
            const aTime = a.startTime || a.StartTime || '';
            const bTime = b.startTime || b.StartTime || '';
            return aTime.localeCompare(bTime);
        });
        
        let html = '<div class="timeline">';
        
        sortedSchedules.forEach((schedule, index) => {
            // Handle both camelCase and PascalCase property names
            const startTime = formatTime(schedule.startTime || schedule.StartTime);
            const endTime = formatTime(schedule.endTime || schedule.EndTime);
            const title = schedule.title || schedule.Title || '';
            const description = schedule.description || schedule.Description;
            const notes = schedule.notes || schedule.Notes;
            const assignments = schedule.assignments || schedule.Assignments || [];
            
            html += `
                <div class="timeline-item">
                    <!-- Time Badge on the left -->
                    <div class="timeline-time">
                        <div class="timeline-time-badge">
                            <span class="time-start">${startTime}</span>
                            <span class="time-range">đến ${endTime}</span>
                        </div>
                    </div>
                    
                    <!-- Marker -->
                    <div class="timeline-marker-wrapper">
                        <div class="timeline-marker"></div>
                    </div>
                    
                    <!-- Content -->
                    <div class="timeline-content">
                        <h6 class="timeline-title">${escapeHtml(title)}</h6>
            `;
            
            if (description) {
                html += `<p class="timeline-description">${escapeHtml(description)}</p>`;
            }
            
            if (notes) {
                html += `
                    <div class="timeline-notes">
                        <i class="bi bi-sticky me-1"></i>
                        <strong>Ghi chú:</strong> ${escapeHtml(notes)}
                    </div>
                `;
            }
            
            if (assignments.length > 0) {
                html += `
                    <div class="timeline-assignments">
                        <small class="text-muted d-block mb-2">
                            <i class="bi bi-people-fill me-1"></i>
                            <strong>Phân công:</strong>
                        </small>
                        <div class="d-flex flex-wrap">
                `;
                
                assignments.forEach(assignment => {
                    const name = assignment.responsibleName || assignment.ResponsibleName || 'Unknown';
                    const role = assignment.role || assignment.Role;
                    const roleText = role ? ` (${escapeHtml(role)})` : '';
                    
                    html += `
                        <span class="assignment-badge">
                            <i class="bi bi-person-fill"></i>
                            ${escapeHtml(name)}${roleText}
                        </span>
                    `;
                });
                
                html += `
                        </div>
                    </div>
                `;
            }
            
            html += `
                    </div>
                </div>
            `;
        });
        
        html += '</div>';
        container.innerHTML = html;
    }
    
    // ===== Initialize Timeline on Page Load =====
    document.addEventListener('DOMContentLoaded', function() {
        if (window.lucide && typeof lucide.createIcons === 'function') {
            lucide.createIcons();
            setTimeout(() => lucide.createIcons(), 100);
        }
        
        // Get activity data from the page
        const activityType = '@Model.Activity.Type';
        const activitySchedules = @Html.Raw(System.Text.Json.JsonSerializer.Serialize(Model.Activity.Schedules ?? new List<BusinessObject.DTOs.Activity.ActivityScheduleDto>()));
        
        console.log('Activity Type:', activityType);
        console.log('Is Complex Activity:', isComplexActivity(activityType));
        console.log('Activity Schedules:', activitySchedules);
        console.log('Schedules count:', activitySchedules ? activitySchedules.length : 0);
        
        // Show timeline section if this is a complex activity
        if (isComplexActivity(activityType)) {
            const scheduleSection = document.getElementById('scheduleDisplaySection');
            if (scheduleSection) {
                scheduleSection.style.display = 'block';
                renderTimeline(activitySchedules);
            }
        }
    });
</script>

<style>
    .timeline {
        position: relative;
    }
    
    .timeline-item {
        display: flex;
        gap: 16px;
        padding-bottom: 24px;
        position: relative;
    }
    
    .timeline-item:not(:last-child)::before {
        content: '';
        position: absolute;
        left: 47px;
        top: 48px;
        bottom: 0;
        width: 2px;
        background: linear-gradient(180deg, #0d6efd 0%, #e9ecef 100%);
    }
    
    .timeline-time {
        flex-shrink: 0;
        width: 95px;
        text-align: center;
    }
    
    .timeline-time-badge {
        display: inline-flex;
        flex-direction: column;
        align-items: center;
        background: linear-gradient(135deg, #0d6efd 0%, #0a58ca 100%);
        color: white;
        padding: 8px 12px;
        border-radius: 12px;
        font-weight: 600;
        font-size: 0.85rem;
        box-shadow: 0 4px 12px rgba(13, 110, 253, 0.3);
        min-width: 85px;
    }
    
    .timeline-time-badge .time-range {
        font-size: 0.75rem;
        opacity: 0.9;
    }
    
    .timeline-time-badge .time-start {
        font-size: 1rem;
        font-weight: 700;
    }
    
    .timeline-marker-wrapper {
        display: flex;
        flex-direction: column;
        align-items: center;
        flex-shrink: 0;
    }
    
    .timeline-marker {
        width: 16px;
        height: 16px;
        border-radius: 50%;
        background: white;
        border: 3px solid #0d6efd;
        box-shadow: 0 0 0 4px rgba(13, 110, 253, 0.15);
        z-index: 1;
    }
    
    .timeline-item:first-child .timeline-marker {
        background: #0d6efd;
        box-shadow: 0 0 0 4px rgba(13, 110, 253, 0.25);
    }
    
    .timeline-content {
        flex: 1;
        background: #f8f9fa;
        border-radius: 12px;
        padding: 16px 20px;
        border: 1px solid #e9ecef;
        transition: all 0.2s ease;
    }
    
    .timeline-content:hover {
        background: #fff;
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
        border-color: #0d6efd;
    }
    
    .timeline-title {
        font-size: 1rem;
        font-weight: 600;
        color: #212529;
        margin-bottom: 4px;
    }
    
    .timeline-description {
        color: #6c757d;
        font-size: 0.9rem;
        margin-bottom: 0;
    }
    
    .timeline-notes {
        background: #e7f1ff;
        border-left: 3px solid #0d6efd;
        padding: 8px 12px;
        border-radius: 0 8px 8px 0;
        margin-top: 10px;
        font-size: 0.85rem;
    }
    
    .timeline-assignments {
        margin-top: 12px;
        padding-top: 12px;
        border-top: 1px dashed #dee2e6;
    }
    
    .assignment-badge {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        background: #e9ecef;
        color: #495057;
        padding: 4px 10px;
        border-radius: 20px;
        font-size: 0.8rem;
        margin: 2px;
    }
    
    .assignment-badge i {
        color: #0d6efd;
    }
</style>

